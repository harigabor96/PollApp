<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://thymeleaf.org">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Gábor Hári"/>
    <title>PollApp</title>
    <link rel="shortcut icon" type="image/png" th:href="@{../favicon.png}"/>
    <link th:href="@{../css/main.css}" rel="stylesheet">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script th:inline="javascript">let chartData = [[${chartData}]];</script>
    <script type="text/javascript" th:src="@{../js/chart.js}"></script>
</head>
<body>
<nav>
    <div class="nav-grid-container">
        <div class="grid-item-nav-title">
            PollApp
        </div>
        <img class="grid-item-nav-img" th:src="@{../images/logo_inverted_small.png}">
        <a class="grid-item-nav-polls" href="/poll-list">View Polls</a>
        <a class="grid-item-nav-create" href="/poll-management/creation">Create a Poll</a>
        <a class="grid-item-sign-out-link" href="/logout">Sign Out</a>
    </div>
</nav>
<header>
    <h1 class="results-title">Poll Results</h1>
    <h3 class="error-box" th:if="${errorMsg != null}" th:text="${errorMsg}"/>
</header>
<section id="results">
    <div class="results-grid-container">
    <div class="chart-div" id="chart-div"></div>
    <table class="result-table">
        <tr class="results-header-question">
            <td colspan="2" th:text="${results.question}"></td>
        </tr>
        <tr>
            <td class="results-header-answer">Answer</td>
            <td class="results-header-vote">Votes</td>
        </tr>
        <tr th:each="result : ${results.answers}">
            <td class="results-answer-td" th:text="${result.answer}"/>
            <td class="results-vote-td" th:text="${result.voteCount}"/>
        </tr>
    </table>
    </div>
    <form class="results-delete-form" th:if="${userRole == 1 || userId == results.creatorId}">
        <button class="results-delete-button" formaction="/poll-management/delete" formmethod="post"
                name="questionId" th:value="${results.questionId}">Delete Poll
        </button>
    </form>
</section>
</body>
</html>